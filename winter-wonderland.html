<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Winter Wonderland: Frosty the Snowman</title>
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800;900&family=Fredoka+One&display=swap" rel="stylesheet" />
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    :root {
      --night:    #04101f;
      --deep:     #0d2048;
      --ocean:    #0a3060;
      --ice:      #4fc3f7;
      --ice-lt:   #b3e5fc;
      --ice-dk:   #0288d1;
      --snow:     #e8f4fd;
      --aurora1:  #00e5a0;
      --aurora2:  #7c3aed;
      --aurora3:  #06b6d4;
      --gold:     #ffd700;
      --gold-dk:  #e6a800;
      --coral:    #ff6b6b;
      --mint:     #00e5a0;
      --white:    #ffffff;
      --text-ice: #b3e5fc;
      --shadow:   rgba(0,150,255,0.2);
      --radius:   18px;
    }

    html, body {
      width: 100%; height: 100%;
      font-family: 'Nunito', sans-serif;
      background: var(--night);
      overflow: hidden;
    }

    /* â”€â”€ Aurora background â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .aurora-bg {
      position: fixed; inset: 0; z-index: 0;
      pointer-events: none;
      background: linear-gradient(180deg, #04101f 0%, #0d2048 60%, #0a3060 100%);
    }
    .aurora-bg::before {
      content: '';
      position: absolute; inset: 0;
      background:
        radial-gradient(ellipse 70% 40% at 20% 20%, rgba(0,229,160,0.18) 0%, transparent 70%),
        radial-gradient(ellipse 60% 35% at 80% 15%, rgba(124,58,237,0.18) 0%, transparent 70%),
        radial-gradient(ellipse 50% 30% at 55% 35%, rgba(6,182,212,0.12) 0%, transparent 70%);
      animation: auroraShift 10s ease-in-out infinite alternate;
    }
    @keyframes auroraShift {
      0%   { opacity: 0.7; transform: translateY(0) scaleX(1); }
      50%  { opacity: 1;   transform: translateY(-12px) scaleX(1.05); }
      100% { opacity: 0.8; transform: translateY(6px) scaleX(0.97); }
    }

    /* â”€â”€ Snow canvas â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    #snow-canvas {
      position: fixed; inset: 0;
      pointer-events: none; z-index: 1;
    }

    /* â”€â”€ Screens â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .screen {
      position: fixed; inset: 0; z-index: 10;
      display: flex; flex-direction: column;
      align-items: center; justify-content: center;
      opacity: 0; pointer-events: none;
      transition: opacity 0.45s ease;
    }
    .screen.active { opacity: 1; pointer-events: all; }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• START SCREEN */
    #start-screen { /* transparent, aurora shows through */ }

    .start-penguin {
      font-size: 90px;
      animation: penguinWaddle 2s ease-in-out infinite;
      filter: drop-shadow(0 0 30px rgba(79,195,247,0.6));
      margin-bottom: 6px;
    }
    .start-snowflakes {
      font-size: 26px; letter-spacing: 10px; opacity: 0.7;
      animation: snowDrift 3s ease-in-out infinite alternate;
      margin-bottom: 14px;
    }
    .start-title {
      font-family: 'Fredoka One', cursive;
      font-size: clamp(28px, 6vw, 52px);
      color: var(--ice-lt);
      text-shadow: 0 0 30px rgba(79,195,247,0.8), 0 0 60px rgba(0,229,160,0.4);
      text-align: center; line-height: 1.15;
      margin-bottom: 6px;
    }
    .start-subtitle {
      font-size: clamp(13px, 2.5vw, 17px);
      color: rgba(179,229,252,0.8);
      font-weight: 700; text-align: center;
      margin-bottom: 28px;
    }
    .start-info {
      display: flex; gap: 14px; flex-wrap: wrap;
      justify-content: center; margin-bottom: 32px;
    }
    .info-chip {
      background: rgba(79,195,247,0.12);
      backdrop-filter: blur(8px);
      border: 1.5px solid rgba(79,195,247,0.35);
      border-radius: 50px;
      padding: 8px 18px;
      color: var(--ice-lt); font-size: 13px; font-weight: 700;
      display: flex; align-items: center; gap: 6px;
    }
    .deco-flake {
      position: absolute;
      font-size: 28px; opacity: 0.5;
      animation: floatFlake 3s ease-in-out infinite;
      user-select: none; pointer-events: none;
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• GAME SCREEN */
    #game-screen { justify-content: flex-start; }

    /* HUD */
    .hud {
      width: 100%; display: flex;
      align-items: center; justify-content: space-between;
      padding: 10px 18px;
      background: rgba(4,16,31,0.6);
      backdrop-filter: blur(12px);
      border-bottom: 1.5px solid rgba(79,195,247,0.2);
      flex-shrink: 0; z-index: 20;
    }
    .hud-level {
      font-family: 'Fredoka One', cursive;
      font-size: clamp(14px, 3vw, 19px);
      color: var(--ice);
      text-shadow: 0 0 10px rgba(79,195,247,0.6);
    }
    .hud-title {
      font-family: 'Fredoka One', cursive;
      font-size: clamp(13px, 2.5vw, 16px);
      color: rgba(179,229,252,0.7);
    }
    .mute-btn {
      background: rgba(79,195,247,0.12);
      border: 1.5px solid rgba(79,195,247,0.3);
      border-radius: 50%; width: 34px; height: 34px;
      cursor: pointer; font-size: 16px; color: var(--ice-lt);
      display: flex; align-items: center; justify-content: center;
      transition: background 0.2s;
    }
    .mute-btn:hover { background: rgba(79,195,247,0.25); }

    /* Level progress strip */
    .level-strip {
      width: 100%; padding: 8px 16px;
      display: flex; align-items: center; gap: 6px;
      flex-shrink: 0;
    }
    .level-block {
      flex: 1; height: 28px; border-radius: 8px;
      display: flex; align-items: center; justify-content: center;
      font-size: 14px; font-weight: 800;
      transition: all 0.4s ease;
      border: 1.5px solid transparent;
    }
    .level-block.cleared {
      background: rgba(0,229,160,0.25);
      border-color: rgba(0,229,160,0.5);
      color: var(--mint);
    }
    .level-block.active {
      background: rgba(255,215,0,0.2);
      border-color: rgba(255,215,0,0.6);
      color: var(--gold);
      box-shadow: 0 0 12px rgba(255,215,0,0.4);
      animation: blockPulse 1.2s ease-in-out infinite;
    }
    .level-block.upcoming {
      background: rgba(79,195,247,0.06);
      border-color: rgba(79,195,247,0.15);
      color: rgba(179,229,252,0.3);
    }

    /* Main area */
    .game-main {
      flex: 1; width: 100%; display: flex;
      flex-direction: column; align-items: center; justify-content: center;
      padding: 10px 16px 16px;
      overflow: hidden; position: relative;
    }

    /* Penguin display */
    .penguin-display {
      display: flex; align-items: center; gap: 14px;
      margin-bottom: 14px;
    }
    .penguin-emoji {
      font-size: clamp(38px, 7vw, 54px);
      animation: penguinFloat 2.5s ease-in-out infinite;
      filter: drop-shadow(0 0 16px rgba(79,195,247,0.6));
    }
    .level-text-block { text-align: left; }
    .level-main-text {
      font-family: 'Fredoka One', cursive;
      font-size: clamp(16px, 3.5vw, 22px);
      color: var(--ice);
    }
    .level-sub-text {
      font-size: clamp(11px, 2vw, 14px);
      color: var(--text-ice);
      font-weight: 700;
    }

    /* Question card */
    .question-card {
      width: 100%; max-width: 620px;
      background: rgba(13,32,72,0.55);
      backdrop-filter: blur(18px);
      border: 1.5px solid rgba(79,195,247,0.25);
      border-radius: var(--radius);
      padding: clamp(14px, 3vw, 22px);
      box-shadow: 0 8px 40px rgba(0,0,0,0.4), inset 0 1px 0 rgba(179,229,252,0.1);
    }
    .q-badge {
      display: inline-flex; align-items: center; gap: 5px;
      font-size: 11px; font-weight: 800;
      letter-spacing: 1px; text-transform: uppercase;
      padding: 4px 12px; border-radius: 20px;
      margin-bottom: 10px;
    }
    .q-badge.math    { background: rgba(0,229,160,0.18); color: var(--mint);   border: 1px solid rgba(0,229,160,0.4); }
    .q-badge.english { background: rgba(79,195,247,0.18); color: var(--ice);   border: 1px solid rgba(79,195,247,0.4); }

    .q-text {
      font-size: clamp(15px, 3vw, 20px);
      font-weight: 800; color: var(--snow);
      line-height: 1.4; margin-bottom: 16px;
    }

    /* Options */
    .options-grid {
      display: grid; grid-template-columns: 1fr 1fr;
      gap: 10px;
    }
    .option-btn {
      font-family: 'Nunito', sans-serif;
      font-size: clamp(13px, 2.5vw, 16px); font-weight: 700;
      background: rgba(79,195,247,0.08);
      border: 1.5px solid rgba(79,195,247,0.2);
      border-radius: 14px;
      padding: clamp(10px, 2vw, 14px) clamp(12px, 2vw, 18px);
      color: var(--snow);
      cursor: pointer; text-align: left;
      display: flex; align-items: center; gap: 10px;
      transition: all 0.18s ease;
      position: relative; overflow: hidden;
      line-height: 1.3;
    }
    .option-btn::before {
      content: ''; position: absolute; inset: 0;
      background: linear-gradient(135deg, rgba(179,229,252,0.05), transparent);
    }
    .option-btn:hover:not(:disabled) {
      background: rgba(79,195,247,0.2);
      border-color: rgba(79,195,247,0.5);
      transform: translateY(-2px);
      box-shadow: 0 4px 18px rgba(79,195,247,0.2);
    }
    .option-btn:active:not(:disabled) { transform: translateY(0); }
    .option-btn.correct {
      background: rgba(0,229,160,0.25) !important;
      border-color: var(--mint) !important;
      box-shadow: 0 0 20px rgba(0,229,160,0.4) !important;
      animation: correctPop 0.4s ease;
    }
    .option-btn.wrong {
      background: rgba(255,107,107,0.25) !important;
      border-color: var(--coral) !important;
      animation: wrongShake 0.4s ease;
    }
    .option-btn:disabled { cursor: not-allowed; }
    .option-letter {
      font-family: 'Fredoka One', cursive; font-size: 14px;
      background: rgba(79,195,247,0.15);
      border-radius: 50%; width: 26px; height: 26px;
      display: flex; align-items: center; justify-content: center;
      flex-shrink: 0;
    }
    .option-btn.correct .option-letter { background: var(--mint);  color: #04101f; }
    .option-btn.wrong   .option-letter { background: var(--coral); color: white; }

    #feedback-msg {
      margin-top: 12px;
      font-family: 'Fredoka One', cursive;
      font-size: clamp(14px, 2.8vw, 18px);
      text-align: center; min-height: 26px;
    }

    /* Mistake counter */
    .mistake-counter {
      display: flex; align-items: center; gap: 8px;
      justify-content: flex-end;
      margin-top: 10px; padding-right: 4px;
      font-family: 'Nunito', sans-serif;
    }
    .mistake-label {
      font-size: 0.78rem; font-weight: 700; letter-spacing: 0.05em;
      color: rgba(255,255,255,0.55); text-transform: uppercase;
    }
    .mistake-pips {
      display: flex; gap: 5px; align-items: center;
    }
    .mistake-pip {
      width: 13px; height: 13px; border-radius: 50%;
      border: 2px solid rgba(255,255,255,0.35);
      background: rgba(255,255,255,0.12);
      transition: background 0.25s ease, border-color 0.25s ease, transform 0.2s ease;
    }
    .mistake-pip.filled {
      background: #ff5c5c;
      border-color: #ff9090;
      box-shadow: 0 0 8px rgba(255,80,80,0.7);
      transform: scale(1.2);
    }
    .mistake-count {
      font-size: 0.85rem; font-weight: 800; color: rgba(255,255,255,0.7);
      min-width: 32px; text-align: right;
    }
    @keyframes pipPop {
      0%   { transform: scale(1.2); }
      50%  { transform: scale(1.6); }
      100% { transform: scale(1.2); }
    }
    .mistake-pip.filled.pop { animation: pipPop 0.3s ease; }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• LEVEL CLEAR SCREEN */
    .level-clear-content { text-align: center; padding: 20px; }
    .lc-penguin { font-size: 80px; animation: slideDown 0.6s cubic-bezier(0.34,1.56,0.64,1); margin-bottom: 10px; }
    .lc-title {
      font-family: 'Fredoka One', cursive;
      font-size: clamp(26px, 6vw, 46px);
      color: var(--ice);
      text-shadow: 0 0 25px rgba(79,195,247,0.8);
      margin-bottom: 8px;
    }
    .lc-sub {
      font-size: clamp(13px, 2.5vw, 17px);
      color: var(--text-ice); font-weight: 700;
      margin-bottom: 20px;
    }
    .ice-row { font-size: 26px; letter-spacing: 8px; animation: iceFloat 1.2s ease-in-out infinite alternate; }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• WIN SCREEN */
    .win-content { text-align: center; padding: 20px; position: relative; z-index: 10; }
    .win-penguin { font-size: 90px; animation: winBounce 0.8s cubic-bezier(0.34,1.8,0.64,1); margin-bottom: 12px; }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• WIN SLIDE SCREEN */
    #win-slide-screen { overflow: hidden; }
    .win-slide-img {
      position: absolute;
      top: -20px; right: -20px;
      width: min(260px, 39vw); height: auto;
      border-radius: 22px;
      box-shadow: 0 0 70px rgba(79,195,247,0.7), 0 12px 40px rgba(0,0,0,0.5);
      animation: frostyDiag 6s ease-in forwards;
    }
    @keyframes frostyDiag {
      0%   { transform: translate(0, 0) rotate(0deg);           opacity: 0; }
      6%   { transform: translate(-6vw, 5vh) rotate(-2deg);     opacity: 1; }
      90%  { opacity: 1; }
      100% { transform: translate(-155vw, 135vh) rotate(-8deg); opacity: 0.2; }
    }
    .win-title {
      font-family: 'Fredoka One', cursive;
      font-size: clamp(30px, 7vw, 54px);
      color: var(--ice);
      text-shadow: 0 0 40px rgba(79,195,247,0.9), 0 0 80px rgba(0,229,160,0.4);
      margin-bottom: 8px;
    }
    .win-sub {
      font-size: clamp(14px, 2.5vw, 19px);
      color: var(--text-ice); font-weight: 700; margin-bottom: 10px;
    }
    .win-hea {
      font-family: 'Fredoka One', cursive;
      font-size: clamp(18px, 3.5vw, 28px);
      color: #ffe66d;
      text-shadow: 0 0 24px rgba(255,230,109,0.8);
      margin-bottom: 24px;
      animation: heaGlow 2s ease-in-out infinite alternate;
    }
    @keyframes heaGlow {
      0%   { text-shadow: 0 0 16px rgba(255,230,109,0.6); }
      100% { text-shadow: 0 0 40px rgba(255,230,109,1), 0 0 80px rgba(255,200,50,0.5); }
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• Shared buttons */
    .btn-action {
      font-family: 'Fredoka One', cursive;
      font-size: clamp(16px, 3vw, 21px);
      border: none; border-radius: 50px;
      padding: 14px 44px;
      cursor: pointer; letter-spacing: 1px;
      transition: transform 0.15s, box-shadow 0.15s;
    }
    .btn-action:hover  { transform: translateY(-3px); }
    .btn-action:active { transform: translateY(1px); }
    .btn-ice  {
      background: linear-gradient(135deg, var(--ice), var(--ice-dk));
      color: #04101f;
      box-shadow: 0 6px 22px rgba(79,195,247,0.4);
    }
    .btn-mint {
      background: linear-gradient(135deg, var(--mint), #00b47a);
      color: #04101f;
      box-shadow: 0 6px 22px rgba(0,229,160,0.4);
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• GAME OVER SCREEN */
    .gameover-content  { text-align: center; padding: 20px; }
    .gameover-penguin  { font-size: 80px; animation: sadWobble 1.4s ease-in-out infinite; margin-bottom: 12px; }
    .gameover-title    {
      font-family: 'Fredoka One', cursive;
      font-size: clamp(28px, 6vw, 46px);
      color: var(--coral);
      text-shadow: 0 0 20px rgba(255,107,107,0.5);
      margin-bottom: 10px;
    }
    .gameover-msg {
      font-size: clamp(15px, 3vw, 20px);
      color: var(--text-ice); font-weight: 700;
      margin-bottom: 28px; line-height: 1.4;
    }
    @keyframes sadWobble { 0%,100%{transform:rotate(-6deg) translateY(0)} 50%{transform:rotate(6deg) translateY(-6px)} }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• Castle Tower */
    .castle-wrap {
      position: absolute; left: 8px; top: 8px; bottom: 8px;
      width: 110px;
      display: flex; flex-direction: column; align-items: center;
      z-index: 5;
    }
    .castle-top { display: flex; gap: 4px; }
    .merlon {
      width: 18px; height: 16px;
      background: linear-gradient(to bottom, #0a2040, #0d2a55);
      border: 1.5px solid rgba(79,195,247,0.45);
      border-bottom: none; border-radius: 2px 2px 0 0;
    }
    .castle-tower {
      width: 76px; flex: 1;
      background: linear-gradient(160deg, #04101f 0%, #0d2a50 60%, #07213a 100%);
      border: 1.5px solid rgba(79,195,247,0.35); border-top: none;
      position: relative;
      display: flex; flex-direction: column;
      overflow: visible;
    }
    .tower-floor {
      flex: 1; display: flex; align-items: center; justify-content: center;
      border-bottom: 1px dashed rgba(79,195,247,0.1);
      transition: background 0.5s;
    }
    .tower-floor:last-child { border-bottom: none; }
    .tower-floor.f-cleared  { background: rgba(0,229,160,0.10); }
    .tower-floor.f-current  { background: rgba(255,215,0,0.13);  }
    .floor-win {
      width: 15px; height: 11px;
      background: rgba(79,195,247,0.08);
      border: 1px solid rgba(79,195,247,0.18);
      border-radius: 3px 3px 0 0; transition: all 0.45s;
    }
    .floor-win.w-cleared {
      background: rgba(0,229,160,0.5); border-color: var(--mint);
      box-shadow: 0 0 5px rgba(0,229,160,0.5);
    }
    .floor-win.w-current {
      background: rgba(255,215,0,0.55); border-color: var(--gold);
      box-shadow: 0 0 9px rgba(255,215,0,0.65);
    }
    .castle-door {
      width: 76px; height: 26px;
      background: linear-gradient(to right, #04101f, #0d2a50);
      border: 1.5px solid rgba(79,195,247,0.35); border-top: none;
      display: flex; align-items: center; justify-content: center;
      font-size: 15px; border-radius: 0 0 5px 5px;
    }
    .snow-pile { font-size: 13px; margin-top: 3px; opacity: 0.6; letter-spacing: 2px; }
    #snowy-castle {
      position: absolute;
      left: 50%; line-height: 1;
      transition: top 0.85s cubic-bezier(0.34, 1.56, 0.64, 1);
      z-index: 10;
      filter: drop-shadow(0 0 18px rgba(255,215,0,0.6));
      animation: snowyHover 2.2s ease-in-out infinite;
    }
    @keyframes snowyHover {
      0%,100% { transform: translateX(-50%) translateY(0); }
      50%      { transform: translateX(-50%) translateY(-6px); }
    }
    .question-area {
      width: 100%; max-width: 560px;
      display: flex; flex-direction: column; gap: 8px;
    }
    .level-header { line-height: 1.3; }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• Level-Clear Slope */
    .lc-slope-scene {
      position: relative;
      width: min(320px, 88vw); height: 150px;
      margin: 0 auto 12px; flex-shrink: 0;
    }
    .lc-slope-track {
      position: absolute; inset: 0;
    }
    .lc-slope-track::before {
      content: '';
      position: absolute;
      width: 200px; height: 4px;
      background: linear-gradient(90deg, transparent, rgba(179,229,252,0.55), transparent);
      border-radius: 2px;
      top: 55%; left: 18px;
      transform: rotate(-18deg); transform-origin: left center;
      box-shadow: 0 2px 12px rgba(79,195,247,0.3);
    }
    #lc-snowy-char {
      position: absolute;
      top: 3%; left: 6%;
      font-size: 72px;
      filter: drop-shadow(0 5px 16px rgba(79,195,247,0.55));
    }
    #lc-snowy-char.sliding {
      animation: slopeSlide 0.95s cubic-bezier(0.22, 1, 0.36, 1) forwards;
    }
    @keyframes slopeSlide {
      0%   { top:3%;  left:6%;  transform:rotate(-18deg) scale(0.75); opacity:0.6; }
      35%  { transform:rotate(7deg) scale(1.12); opacity:1; }
      65%  { transform:rotate(-4deg) scale(1.05); }
      100% { top:42%; left:54%; transform:rotate(0deg) scale(1); opacity:1; }
    }
    .lc-snow-puffs {
      position: absolute; bottom: 4%; left: 42%;
      font-size: 13px; letter-spacing: 4px;
      animation: puffAway 1.0s ease-out 0.5s both;
    }
    @keyframes puffAway {
      0%   { opacity:1; transform:translate(0,0) scale(1); }
      100% { opacity:0; transform:translate(-35px,-50px) scale(0.2); }
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• Frosty image sizing */
    .start-penguin img    { width: 90px;  height: auto; }
    #snowy-castle  img    { width: 100px; height: auto; display: block; }
    #lc-snowy-char img    { width: 72px;  height: auto; }
    .win-penguin   img    { width: 90px;  height: auto; }
    .gameover-penguin img { width: 80px;  height: auto; }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• Scene Screen */
    #scene-screen { /* aurora + snow canvas show through */ }

    .scene-ground {
      position: absolute; bottom: 0; left: 0; right: 0; height: 30%;
      background: linear-gradient(to bottom, #c8e8f8 0%, #e0f3fc 50%, #f0f8ff 100%);
      border-radius: 60% 60% 0 0 / 30px 30px 0 0;
      box-shadow: 0 -6px 24px rgba(79,195,247,0.35);
      z-index: 2;
    }
    .scene-ground::after {
      content: '';
      position: absolute; top: -8px; left: 8%; right: 8%; height: 16px;
      background: radial-gradient(ellipse, rgba(255,255,255,0.9) 0%, transparent 70%);
      border-radius: 50%;
    }
    .scene-tree {
      position: absolute; z-index: 3;
      filter: drop-shadow(0 6px 14px rgba(0,80,180,0.35));
      animation: treeSway var(--sw, 3s) ease-in-out infinite;
      transform-origin: bottom center; user-select: none; pointer-events: none;
    }
    @keyframes treeSway { 0%,100%{transform:rotate(-1.5deg)} 50%{transform:rotate(1.5deg)} }

    .scene-hud {
      position: absolute; top: 14px; left: 0; right: 0;
      text-align: center; z-index: 20; pointer-events: none;
    }
    .scene-level-label {
      font-family: 'Fredoka One', cursive;
      font-size: clamp(18px, 4vw, 26px);
      color: var(--ice); text-shadow: 0 0 18px rgba(79,195,247,0.8);
      margin-bottom: 4px;
    }
    .scene-instruction {
      font-size: clamp(12px, 2.5vw, 15px);
      color: var(--text-ice); font-weight: 700;
      animation: instrPulse 2s ease-in-out infinite alternate;
    }
    @keyframes instrPulse {
      0%   { opacity: 0.65; }
      100% { opacity: 1; text-shadow: 0 0 10px rgba(255,215,0,0.5); }
    }
    .scene-object {
      position: absolute; cursor: pointer; z-index: 10;
      font-size: clamp(30px, 7vw, 48px);
      filter: drop-shadow(0 4px 10px rgba(0,0,0,0.45));
      animation: objFloat var(--fd, 2.5s) ease-in-out infinite;
      transition: filter 0.18s ease;
      user-select: none;
    }
    .scene-object:hover {
      filter: drop-shadow(0 0 16px rgba(255,215,0,0.9)) drop-shadow(0 4px 10px rgba(0,0,0,0.4));
      animation-play-state: paused;
      transform: scale(1.35) translateY(-5px);
    }
    @keyframes objFloat {
      0%,100% { transform: translateY(0); }
      50%      { transform: translateY(-10px); }
    }
    @keyframes objBurst {
      0%   { transform: scale(1)   rotate(0deg);   opacity: 1; }
      45%  { transform: scale(2.2) rotate(25deg);  opacity: 1; }
      100% { transform: scale(0)   rotate(200deg); opacity: 0; }
    }
    .obj-clicked {
      animation: objBurst 0.48s cubic-bezier(0.36,0.07,0.19,0.97) forwards !important;
      pointer-events: none;
    }
    @keyframes objShake {
      0%,100% { transform: translateX(0) scale(1.1); }
      20%     { transform: translateX(-8px) scale(1.1); }
      40%     { transform: translateX(8px) scale(1.1); }
      60%     { transform: translateX(-5px) scale(1.1); }
      80%     { transform: translateX(5px) scale(1.1); }
    }
    .obj-wrong {
      animation: objShake 0.4s ease forwards !important;
      pointer-events: none;
      filter: drop-shadow(0 0 14px rgba(255,80,80,0.9)) !important;
    }

    /* Try Again toast */
    #scene-toast {
      position: absolute; top: 28%; left: 50%; transform: translateX(-50%) scale(0.8);
      background: rgba(20,10,40,0.88); border: 2px solid rgba(255,100,100,0.7);
      border-radius: 18px; padding: 14px 28px;
      color: #fff; font-family: 'Nunito', sans-serif; font-size: 1.1rem; font-weight: 700;
      text-align: center; white-space: nowrap; z-index: 50;
      opacity: 0; pointer-events: none;
      transition: opacity 0.18s ease, transform 0.18s ease;
      backdrop-filter: blur(8px);
    }
    #scene-toast.toast-show {
      opacity: 1; transform: translateX(-50%) scale(1);
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• Particles */
    .snow-particle {
      position: fixed; pointer-events: none;
      animation: particleFly 1.3s ease-out forwards;
      z-index: 100; font-size: 18px;
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• Animations */
    @keyframes penguinWaddle  { 0%,100%{transform:rotate(-4deg) translateY(0)} 50%{transform:rotate(4deg) translateY(-10px)} }
    @keyframes penguinFloat   { 0%,100%{transform:translateY(0)} 50%{transform:translateY(-9px)} }
    @keyframes snowDrift      { 0%{transform:translateX(-6px)} 100%{transform:translateX(6px)} }
    @keyframes floatFlake     { 0%,100%{transform:translateY(0) rotate(0deg)} 50%{transform:translateY(-10px) rotate(20deg)} }
    @keyframes blockPulse     { 0%,100%{transform:scale(1)} 50%{transform:scale(1.08)} }
    @keyframes correctPop     { 0%{transform:scale(1)} 50%{transform:scale(1.06)} 100%{transform:scale(1)} }
    @keyframes wrongShake     { 0%{transform:translateX(0)} 20%{transform:translateX(-7px)} 40%{transform:translateX(7px)} 60%{transform:translateX(-5px)} 80%{transform:translateX(5px)} 100%{transform:translateX(0)} }
    @keyframes slideDown      { 0%{transform:translateY(-60px) scale(0.5)} 100%{transform:translateY(0) scale(1)} }
    @keyframes iceFloat       { 0%{transform:translateY(0) scale(1)} 100%{transform:translateY(-8px) scale(1.1)} }
    @keyframes winBounce      { 0%{transform:scale(0)} 60%{transform:scale(1.2)} 80%{transform:scale(0.95)} 100%{transform:scale(1)} }
    @keyframes particleFly    { 0%{opacity:1;transform:translate(0,0) scale(1)} 100%{opacity:0;transform:translate(var(--dx),var(--dy)) scale(0.3)} }
    @keyframes screenShake    { 0%,100%{transform:translate(0,0)} 20%{transform:translate(-5px,3px)} 40%{transform:translate(5px,-3px)} 60%{transform:translate(-4px,3px)} 80%{transform:translate(4px,-2px)} }
    .shake { animation: screenShake 0.35s ease !important; }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• RULES SCREEN */
    .rules-screen-title {
      font-family: 'Fredoka One', cursive;
      font-size: clamp(18px, 4vw, 26px);
      color: var(--ice-lt);
      text-shadow: 0 0 24px rgba(79,195,247,0.8), 0 0 48px rgba(0,229,160,0.3);
      text-align: center;
      margin-bottom: 18px;
    }

    .rules-card {
      background: rgba(13,32,72,0.62);
      backdrop-filter: blur(20px);
      border: 1.5px solid rgba(79,195,247,0.3);
      border-radius: 22px;
      padding: clamp(16px, 3.5vw, 28px);
      max-width: 600px;
      width: calc(100% - 32px);
      box-shadow: 0 10px 45px rgba(0,0,0,0.45), inset 0 1px 0 rgba(179,229,252,0.1);
    }

    .rules-speaker-row {
      display: flex;
      align-items: flex-start;
      gap: 14px;
      margin-bottom: 18px;
    }

    .rules-frosty-img {
      flex-shrink: 0;
      animation: penguinWaddle 2.2s ease-in-out infinite;
      filter: drop-shadow(0 0 18px rgba(79,195,247,0.55));
    }
    .rules-frosty-img img { width: 72px; height: auto; }

    .speech-bubble {
      flex: 1;
      background: rgba(232,244,253,0.95);
      border-radius: 4px 16px 16px 16px;
      padding: 14px 16px;
      position: relative;
      box-shadow: 0 4px 20px rgba(0,0,0,0.25);
    }
    .speech-bubble::before {
      content: '';
      position: absolute;
      left: -12px; top: 16px;
      width: 0; height: 0;
      border-top: 8px solid transparent;
      border-bottom: 8px solid transparent;
      border-right: 12px solid rgba(232,244,253,0.95);
    }

    .speech-hi {
      font-family: 'Fredoka One', cursive;
      font-size: clamp(13px, 2.5vw, 17px);
      color: #0d2048;
      margin-bottom: 10px;
    }

    .rules-list {
      list-style: none;
      padding: 0; margin: 0;
      display: flex;
      flex-direction: column;
      gap: 6px;
    }
    .rules-list li {
      font-family: 'Nunito', sans-serif;
      font-size: clamp(11px, 2vw, 13px);
      font-weight: 700;
      color: #0a2040;
      line-height: 1.4;
    }

    .rules-friends-bar {
      text-align: center;
      border-top: 1px solid rgba(79,195,247,0.2);
      padding-top: 14px;
    }
    .rules-friends-label {
      font-size: 11px;
      font-weight: 700;
      color: rgba(179,229,252,0.65);
      letter-spacing: 0.8px;
      text-transform: uppercase;
      margin-bottom: 6px;
    }
    .rules-friends-emoji {
      font-size: clamp(22px, 5vw, 32px);
      letter-spacing: 10px;
      animation: friendsBounce 1.8s ease-in-out infinite alternate;
    }
    @keyframes friendsBounce {
      0%   { transform: translateY(0) scale(1); }
      100% { transform: translateY(-5px) scale(1.06); }
    }
  </style>
</head>
<body>

<div class="aurora-bg"></div>
<canvas id="snow-canvas"></canvas>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• START SCREEN -->
<div class="screen active" id="start-screen">
  <div class="start-penguin"><img src="frosty.png" alt="Frosty"></div>
  <div class="start-title">Winter Wonderland<br>Frosty the Snowman</div>
  <button class="btn-action btn-ice" onclick="showRules()" style="margin-top:32px">â„ï¸ Play â„ï¸</button>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• RULES SCREEN -->
<div class="screen" id="rules-screen">
  <div class="rules-screen-title">â„ï¸ Frosty's Got Something to Say! â„ï¸</div>
  <div class="rules-card">
    <div class="rules-speaker-row">
      <div class="rules-frosty-img">
        <img src="frosty.png" alt="Frosty">
      </div>
      <div class="speech-bubble">
        <div class="speech-hi">Hi friends! ğŸ‘‹ I need your help â€” listen up!</div>
        <ul class="rules-list">
          <li>ğŸ° I'm trapped inside a spooky ice castle and I can't get out!</li>
          <li>ğŸ¯ There are <strong>10 levels</strong> standing between me and my freedom!</li>
          <li>ğŸ” Each level, look for a <strong>magic hidden object</strong> in the winter scene and click it!</li>
          <li>ğŸ“ Then answer a <strong>Math</strong> or <strong>English</strong> question correctly to unlock my next escape route!</li>
          <li>â¤ï¸ Be careful â€” we only get <strong>3 mistakes</strong> the whole game!</li>
          <li>ğŸ‰ Answer all 10 and I'll finally be FREE! Let's do this! â­</li>
        </ul>
      </div>
    </div>
    <div class="rules-friends-bar">
      <div class="rules-friends-label">Frosty's friends are cheering you on!</div>
      <div class="rules-friends-emoji">ğŸ§ ğŸ¦Œ ğŸ»â€â„ï¸ ğŸ¦Š ğŸ¿ï¸</div>
    </div>
  </div>
  <button class="btn-action btn-mint" onclick="startGame()" style="margin-top:24px">â­ Let's Go! â­</button>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• SCENE SCREEN -->
<div class="screen" id="scene-screen">

  <!-- Frosted pine trees (static decoration) -->
  <div class="scene-tree" style="--sw:3.2s; font-size:clamp(44px,9vw,66px); left:2%;  bottom:27%">ğŸŒ²</div>
  <div class="scene-tree" style="--sw:2.7s; font-size:clamp(30px,6vw,46px); left:13%; bottom:28%">ğŸŒ²</div>
  <div class="scene-tree" style="--sw:3.6s; font-size:clamp(36px,7vw,54px); left:22%; bottom:26%">ğŸŒ²</div>
  <div class="scene-tree" style="--sw:2.9s; font-size:clamp(28px,5vw,40px); left:42%; bottom:29%">ğŸŒ²</div>
  <div class="scene-tree" style="--sw:3.4s; font-size:clamp(50px,10vw,72px);left:56%; bottom:26%">ğŸŒ²</div>
  <div class="scene-tree" style="--sw:2.5s; font-size:clamp(32px,6vw,48px); left:72%; bottom:28%">ğŸŒ²</div>
  <div class="scene-tree" style="--sw:3.1s; font-size:clamp(42px,8vw,62px); left:84%; bottom:27%">ğŸŒ²</div>

  <!-- Snow ground -->
  <div class="scene-ground"></div>

  <!-- Level info -->
  <div class="scene-hud">
    <div class="scene-level-label" id="scene-level-label">â„ï¸ Level 10</div>
    <div class="scene-instruction">âœ¨ Click on a hidden object to reveal your challenge! âœ¨</div>
  </div>

  <!-- Clickable objects injected by JS -->
  <div id="scene-objects"></div>

  <!-- Try Again toast -->
  <div id="scene-toast">â„ï¸ Not this one â€” keep looking! â„ï¸</div>

</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• GAME SCREEN -->
<div class="screen" id="game-screen">
  <div class="hud">
    <div class="hud-level" id="hud-level">ğŸ”ï¸ Level 10</div>
    <div class="hud-title">Winter Wonderland</div>
    <button class="mute-btn" id="mute-btn" onclick="toggleMute()" title="Mute/Unmute">ğŸ”Š</button>
  </div>

  <!-- Level progress strip (10 blocks) -->
  <div class="level-strip" id="level-strip"></div>

  <!-- Main content -->
  <div class="game-main">

    <!-- Castle tower â€” absolutely positioned on the left -->
    <div class="castle-wrap">
      <div class="castle-top">
        <div class="merlon"></div>
        <div class="merlon"></div>
        <div class="merlon"></div>
      </div>
      <div class="castle-tower" id="castle-tower">
        <!-- 10 floor divs injected by JS -->
        <div id="snowy-castle"><img src="frosty.png" alt="Frosty"></div>
      </div>
      <div class="castle-door">ğŸšª</div>
      <div class="snow-pile">â„ â„ â„</div>
    </div>

    <!-- Question area â€” centered -->
    <div class="question-area">
      <div class="level-header">
        <div class="level-main-text" id="level-main-text">Level 10 of 10</div>
        <div class="level-sub-text"  id="level-sub-text">Help Frosty escape!</div>
      </div>
      <div class="question-card">
        <div class="q-badge math" id="q-badge">ğŸ”¢ Math</div>
        <div class="q-text" id="q-text">Loading...</div>
        <div class="options-grid" id="options-grid"></div>
        <div id="feedback-msg"></div>
      </div>
      <!-- Mistake counter â€” bottom right of question area -->
      <div class="mistake-counter" id="mistake-counter">
        <span class="mistake-label">Mistakes</span>
        <span class="mistake-pips" id="mistake-pips"></span>
        <span class="mistake-count" id="mistake-count">0 / 3</span>
      </div>
    </div>

  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• LEVEL CLEAR SCREEN -->
<div class="screen" id="level-clear-screen">
  <div class="level-clear-content">
    <!-- Frosty slides down a snowy slope -->
    <div class="lc-slope-scene">
      <div class="lc-slope-track"></div>
      <div id="lc-snowy-char"><img src="frosty.png" alt="Frosty"></div>
      <div class="lc-snow-puffs">â„ â„ â„</div>
    </div>
    <div class="lc-title" id="lc-title">Level 10 Cleared! â­</div>
    <div class="lc-sub"   id="lc-sub">Frosty slides to the next level! â„ï¸</div>
    <div class="ice-row">â„ï¸ â­ â„ï¸ â­ â„ï¸</div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• WIN SLIDE SCREEN -->
<div class="screen" id="win-slide-screen">
  <img class="win-slide-img" src="Snowy with Reindeers.png" alt="Frosty riding with reindeers">
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• WIN SCREEN -->
<div class="screen" id="win-screen">
  <div class="win-content">
    <div class="win-penguin"><img src="frosty.png" alt="Frosty"></div>
    <div class="win-title">ğŸ‰ Frosty Escaped! ğŸ‰</div>
    <div class="win-sub">
      â„ï¸ You helped Frosty the Snowman escape the ice castle! â„ï¸
    </div>
    <div class="win-hea">âœ¨ ...and Frosty lived happily ever after âœ¨</div>
    <button class="btn-action btn-mint" onclick="restartGame()">ğŸ”„ Play Again!</button>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• GAME OVER SCREEN -->
<div class="screen" id="gameover-screen">
  <div class="gameover-content">
    <div class="gameover-penguin"><img src="frosty.png" alt="Frosty"></div>
    <div class="gameover-title">Oh no!</div>
    <div class="gameover-msg">Frosty is still stuck at the castle ğŸ˜¢</div>
    <div style="font-size:38px;margin:18px 0;letter-spacing:6px">ğŸ”ï¸â„ï¸ğŸ°â„ï¸ğŸ”ï¸</div>
    <button class="btn-action btn-ice" onclick="restartGame()">ğŸ”„ Try Again!</button>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• SCRIPT -->
<script>
'use strict';

/* â”€â”€ 1. QUESTION POOL (45 questions from Princess Quest) â”€â”€â”€â”€â”€â”€â”€â”€ */
const ALL_QUESTIONS = [
  { type:'math',    q:'What is 7 Ã— 8?',
    opts:['54','56','48','63'], ans:1 },
  { type:'english', q:'What does the word "courageous" mean?',
    opts:['Very tired','Always kind','Brave and fearless','Very smart'], ans:2 },
  { type:'math',    q:'24 Ã· 6 = ?',
    opts:['4','5','3','6'], ans:0 },
  { type:'math',    q:'What is Â½ + Â¼?',
    opts:['2/6','3/4','1/3','2/3'], ans:1 },
  { type:'english', q:'Which word is a synonym (same meaning) for "happy"?',
    opts:['Sad','Angry','Joyful','Tired'], ans:2 },
  { type:'math',    q:'15 Ã— 4 = ?',
    opts:['50','60','55','45'], ans:1 },
  { type:'math',    q:'What is the perimeter of a square with sides of 5 cm?',
    opts:['25 cm','10 cm','20 cm','15 cm'], ans:2 },
  { type:'english', q:'What is the antonym (opposite) of "ancient"?',
    opts:['Old','Modern','Historical','Wise'], ans:1 },
  { type:'math',    q:'Â¾ of 20 = ?',
    opts:['15','10','12','8'], ans:0 },
  { type:'math',    q:'45 Ã· 9 = ?',
    opts:['6','5','4','7'], ans:1 },
  { type:'english', q:'What does "enormous" mean?',
    opts:['Tiny','Very large','Beautiful','Very fast'], ans:1 },
  { type:'math',    q:'12.5 + 7.3 = ?',
    opts:['19.8','18.8','20.8','19.3'], ans:0 },
  { type:'math',    q:'If there are 4 groups of 9, how many are there in total?',
    opts:['27','36','32','40'], ans:1 },
  { type:'english', q:'Which word means "to make something better"?',
    opts:['Worsen','Improve','Delete','Confuse'], ans:1 },
  { type:'math',    q:'100 âˆ’ 37 = ?',
    opts:['73','63','53','67'], ans:1 },
  { type:'math',    q:'56 Ã· 7 = ?',
    opts:['7','8','6','9'], ans:1 },
  { type:'english', q:'What does "curious" mean?',
    opts:['Very bored','Eager to learn or know more','Very angry','Very sleepy'], ans:1 },
  { type:'math',    q:'A rectangle has length 8 and width 3. What is its area?',
    opts:['22','11','24','18'], ans:2 },
  { type:'math',    q:'What is 9 Ã— 9?',
    opts:['81','72','63','90'], ans:0 },
  { type:'english', q:'Which word is an antonym of "generous"?',
    opts:['Kind','Giving','Selfish','Friendly'], ans:2 },
  { type:'math',    q:'250 + 175 = ?',
    opts:['425','325','415','435'], ans:0 },
  { type:'math',    q:'What is â…œ of 24?',
    opts:['6','8','9','12'], ans:2 },
  { type:'english', q:'What does "timid" mean?',
    opts:['Bold and loud','Shy and nervous','Very clever','Very funny'], ans:1 },
  { type:'math',    q:'7 Ã— 12 = ?',
    opts:['74','84','94','64'], ans:1 },
  { type:'math',    q:'500 Ã· 25 = ?',
    opts:['20','25','15','10'], ans:0 },
  { type:'english', q:'A large group of fish swimming together is called a ___.',
    opts:['Pack','Flock','School','Herd'], ans:2 },
  { type:'math',    q:'What is 4Â² (4 squared)?',
    opts:['8','12','16','20'], ans:2 },
  { type:'math',    q:'A pizza is cut into 8 slices. You eat 3. What fraction did you eat?',
    opts:['3/5','5/8','3/8','1/3'], ans:2 },
  { type:'english', q:'What is the correct plural of "wolf"?',
    opts:['Wolfs','Wolves','Wolfes','Wolvs'], ans:1 },
  { type:'math',    q:'14 Ã— 5 = ?',
    opts:['65','60','70','75'], ans:2 },
  { type:'math',    q:'What is 0.5 Ã— 10?',
    opts:['0.05','50','5','500'], ans:2 },
  { type:'english', q:'What does "magnificent" mean?',
    opts:['Ordinary and plain','Splendid and impressive','Very boring','Very small'], ans:1 },
  { type:'math',    q:'72 Ã· 8 = ?',
    opts:['8','9','7','6'], ans:1 },
  { type:'math',    q:'What is the area of a square with sides of 6 units?',
    opts:['24','30','36','12'], ans:2 },
  { type:'english', q:'Which word is a synonym for "difficult"?',
    opts:['Easy','Simple','Challenging','Quick'], ans:2 },
  { type:'math',    q:'135 + 246 = ?',
    opts:['371','381','391','361'], ans:1 },
  { type:'math',    q:'1000 âˆ’ 427 = ?',
    opts:['573','483','673','563'], ans:0 },
  { type:'english', q:'What does "transparent" mean?',
    opts:['Completely opaque','Very colorful','See-through','Invisible'], ans:2 },
  { type:'math',    q:'6 Ã— 11 = ?',
    opts:['62','66','68','72'], ans:1 },
  { type:'math',    q:'What is â…– + â…–?',
    opts:['4/10','4/5','2/5','1'], ans:1 },
  { type:'english', q:'Which word means "very, very tired"?',
    opts:['Energetic','Exhausted','Excited','Enthusiastic'], ans:1 },
  { type:'math',    q:'Apples cost $0.50 each. How much do 6 apples cost?',
    opts:['$2.50','$3.00','$3.50','$4.00'], ans:1 },
  { type:'math',    q:'What is 25% of 80?',
    opts:['20','25','40','15'], ans:0 },
  { type:'english', q:'What does "persevere" mean?',
    opts:['Give up easily','Keep trying despite challenges','Ask for help right away','Take a long rest'], ans:1 },
  { type:'math',    q:'A train travels 60 miles per hour. How far does it go in 3 hours?',
    opts:['160 miles','180 miles','200 miles','120 miles'], ans:1 }
];

/* â”€â”€ 2. SHUFFLE + PICK 10 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function shuffle(arr) {
  for (let i = arr.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [arr[i], arr[j]] = [arr[j], arr[i]];
  }
  return arr;
}

function pickQuestions() {
  return shuffle([...ALL_QUESTIONS]).slice(0, 10);
}

/* â”€â”€ 3. AUDIO ENGINE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
const Audio = (() => {
  let ctx = null, muted = false, bgTimeout = null, bgIdx = 0;

  function init() {
    if (ctx) return;
    try { ctx = new (window.AudioContext || window.webkitAudioContext)(); } catch(e) {}
  }

  function note(freq, dur, type='triangle', vol=0.25, delay=0) {
    if (!ctx || muted) return;
    const osc = ctx.createOscillator();
    const gain = ctx.createGain();
    osc.connect(gain); gain.connect(ctx.destination);
    osc.type = type; osc.frequency.value = freq;
    const t = ctx.currentTime + delay;
    gain.gain.setValueAtTime(vol, t);
    gain.gain.exponentialRampToValueAtTime(0.001, t + dur);
    osc.start(t); osc.stop(t + dur + 0.01);
  }

  function correct() {
    note(659,  0.15, 'triangle', 0.28, 0);
    note(784,  0.15, 'triangle', 0.28, 0.13);
    note(1047, 0.15, 'triangle', 0.28, 0.26);
    note(1319, 0.38, 'triangle', 0.24, 0.39);
  }

  function wrong() {
    note(392, 0.12, 'sawtooth', 0.2,  0);
    note(330, 0.12, 'sawtooth', 0.2,  0.1);
    note(262, 0.28, 'sawtooth', 0.18, 0.2);
  }

  function levelClear() {
    const m=[523,659,784,1047,784,1047,1319];
    const d=[0.1,0.1,0.1,0.18,0.1,0.15,0.5];
    let t=0; m.forEach((f,i)=>{ note(f,d[i],'triangle',0.28,t); t+=d[i]+0.03; });
  }

  function win() {
    const m=[784,880,1047,880,1047,1319,1175,1319,1568];
    const d=[0.1,0.1,0.12,0.1,0.12,0.15,0.1,0.12,0.6];
    let t=0; m.forEach((f,i)=>{ note(f,d[i],'triangle',0.28,t); t+=d[i]+0.02; });
  }

  /* wintery pentatonic music-box melody */
  const BG = [
    [1047,0.7],[880,0.7],[784,0.7],[1047,0.7],[1319,0.7],
    [1175,0.7],[1047,0.7],[880,1.0],[784,0.7],[659,0.7],
    [784,0.7],[1047,0.7],[880,0.7],[784,1.0],[1047,1.2]
  ];

  function bgTick() {
    if (!ctx || muted) { bgTimeout = setTimeout(bgTick, 500); return; }
    const [freq, dur] = BG[bgIdx % BG.length];
    bgIdx++;
    const osc = ctx.createOscillator();
    const gain = ctx.createGain();
    osc.connect(gain); gain.connect(ctx.destination);
    osc.type = 'triangle'; osc.frequency.value = freq;
    gain.gain.setValueAtTime(0.05, ctx.currentTime);
    gain.gain.exponentialRampToValueAtTime(0.001, ctx.currentTime + dur * 0.88);
    osc.start(ctx.currentTime); osc.stop(ctx.currentTime + dur);
    bgTimeout = setTimeout(bgTick, dur * 1000);
  }

  function startBg() { stopBg(); bgIdx=0; bgTimeout=setTimeout(bgTick,400); }
  function stopBg()  { if(bgTimeout){clearTimeout(bgTimeout);bgTimeout=null;} }
  function toggleMute() { muted=!muted; return muted; }

  /* cheerful C-major pentatonic celebration melody */
  const CHEERFUL = [
    [1047,0.18],[1319,0.18],[1568,0.18],[1319,0.18],
    [1047,0.18],[880, 0.18],[1047,0.35],[784, 0.18],
    [880, 0.18],[1047,0.18],[1319,0.18],[1568,0.35],
    [1319,0.18],[1047,0.18],[880, 0.18],[1047,0.35],
    [784, 0.18],[880, 0.18],[1047,0.18],[1319,0.18],
    [1568,0.18],[1319,0.18],[1047,0.35],[880, 0.35],
  ];

  function cheerfulTick() {
    if (!ctx || muted) { bgTimeout = setTimeout(cheerfulTick, 200); return; }
    const [freq, dur] = CHEERFUL[bgIdx % CHEERFUL.length];
    bgIdx++;
    const osc = ctx.createOscillator();
    const gain = ctx.createGain();
    osc.connect(gain); gain.connect(ctx.destination);
    osc.type = 'triangle'; osc.frequency.value = freq;
    gain.gain.setValueAtTime(0.13, ctx.currentTime);
    gain.gain.exponentialRampToValueAtTime(0.001, ctx.currentTime + dur * 0.82);
    osc.start(ctx.currentTime); osc.stop(ctx.currentTime + dur);
    bgTimeout = setTimeout(cheerfulTick, dur * 1000);
  }

  function startCheerfulBg() { stopBg(); bgIdx=0; bgTimeout=setTimeout(cheerfulTick,100); }

  return { init, correct, wrong, levelClear, win, startBg, stopBg, toggleMute, startCheerfulBg };
})();

/* â”€â”€ 4. SNOWFLAKE CANVAS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
(function initSnow() {
  const canvas = document.getElementById('snow-canvas');
  const dpr = window.devicePixelRatio || 1;
  const flakes = [];

  function resize() {
    canvas.width  = window.innerWidth  * dpr;
    canvas.height = window.innerHeight * dpr;
    canvas.style.width  = window.innerWidth  + 'px';
    canvas.style.height = window.innerHeight + 'px';
  }
  resize();
  window.addEventListener('resize', resize);

  for (let i = 0; i < 65; i++) {
    flakes.push({
      x:     Math.random() * window.innerWidth,
      y:     Math.random() * window.innerHeight,
      r:     Math.random() * 2.5 + 0.8,
      speed: Math.random() * 0.6 + 0.25,
      drift: Math.random() * 0.4 - 0.2,
      phase: Math.random() * Math.PI * 2,
      alpha: Math.random() * 0.5 + 0.2
    });
  }

  const ctx2 = canvas.getContext('2d');
  let t = 0;

  function draw() {
    ctx2.clearRect(0, 0, canvas.width, canvas.height);
    flakes.forEach(f => {
      const sw = canvas.width  / dpr;
      const sh = canvas.height / dpr;

      f.y += f.speed;
      f.x += f.drift + Math.sin(f.phase + t * 0.5) * 0.3;
      if (f.y > sh + 10) { f.y = -10; f.x = Math.random() * sw; }
      if (f.x > sw + 10) f.x = -10;
      if (f.x < -10)     f.x = sw + 10;

      ctx2.beginPath();
      ctx2.arc(f.x * dpr, f.y * dpr, f.r * dpr, 0, Math.PI * 2);
      ctx2.fillStyle = `rgba(200,235,255,${f.alpha})`;
      ctx2.fill();
    });
    t += 0.016;
    requestAnimationFrame(draw);
  }
  draw();
})();

/* â”€â”€ 5. GAME STATE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
const State = {
  levelIdx:  0,      // 0 = Level 10, 9 = Level 1
  questions: [],     // 10 questions for this run
  answering: false,
  wrongCount: 0,     // wrong attempts for whole game (max 3)
};

/* â”€â”€ 6. SCENE DATA â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
const SCENE_OBJECTS = [
  'ğŸ¦','ğŸ‡','ğŸ¦Š','ğŸ¦Œ','ğŸ„','ğŸ›·','ğŸ§¤','ğŸ¿',
  'ğŸªµ','ğŸŒŸ','ğŸ’','ğŸ¦‰','ğŸª¨','ğŸ””','ğŸ§Š','ğŸŒ™',
  'ğŸª¶','ğŸ¦‹','ğŸ¿ï¸','ğŸ„','ğŸ§¸','ğŸ«§','ğŸ”ï¸','ğŸ‚'
];

// 5 scattered positions: alternating low/high for a natural look
const SCENE_POSITIONS = [
  { left:'8%',  bottom:'33%' },
  { left:'28%', bottom:'45%' },
  { left:'50%', bottom:'35%' },
  { left:'67%', bottom:'47%' },
  { left:'84%', bottom:'34%' },
];

let _sceneCorrectIdx = 0;

function showScene() {
  const levelNum = 10 - State.levelIdx;
  document.getElementById('scene-level-label').textContent = `â„ï¸ Level ${levelNum} of 10 â„ï¸`;

  // Fresh random objects for this scene
  const picked = shuffle([...SCENE_OBJECTS]).slice(0, 5);
  // Randomly pick which object is the "magic" one
  _sceneCorrectIdx = Math.floor(Math.random() * 5);

  const container = document.getElementById('scene-objects');
  container.innerHTML = '';

  SCENE_POSITIONS.forEach((pos, i) => {
    const div = document.createElement('div');
    div.className = 'scene-object';
    div.textContent = picked[i];
    div.style.left   = pos.left;
    div.style.bottom = pos.bottom;
    div.style.setProperty('--fd', (2.1 + i * 0.35) + 's');
    div.style.animationDelay = (i * 0.18) + 's';
    div.title = 'Click me!';
    div.dataset.idx = i;
    div.onclick = () => handleObjectClick(div);
    container.appendChild(div);
  });

  showScreen('scene-screen');
}

let _toastTimer = null;

function handleObjectClick(btn) {
  const idx = parseInt(btn.dataset.idx);

  if (idx === _sceneCorrectIdx) {
    // Correct object â€” burst and reveal question
    document.querySelectorAll('.scene-object').forEach(o => o.style.pointerEvents = 'none');
    btn.classList.add('obj-clicked');
    setTimeout(() => showScreen('game-screen'), 520);
  } else {
    // Wrong object â€” shake it and show toast
    btn.classList.add('obj-wrong');
    showSceneToast();
    setTimeout(() => {
      btn.classList.remove('obj-wrong');
      btn.style.pointerEvents = '';
    }, 500);
  }
}

function showSceneToast() {
  const toast = document.getElementById('scene-toast');
  clearTimeout(_toastTimer);
  toast.classList.remove('toast-show');
  toast.offsetHeight; // force reflow
  toast.classList.add('toast-show');
  _toastTimer = setTimeout(() => toast.classList.remove('toast-show'), 1600);
}

/* â”€â”€ 7. SCREEN MANAGEMENT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function showScreen(id) {
  document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
  document.getElementById(id).classList.add('active');
}

/* â”€â”€ 7. CASTLE TOWER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function initTower() {
  const tower = document.getElementById('castle-tower');
  // Remove old floor divs but keep #snowy-castle
  Array.from(tower.children).forEach(c => { if (c.id !== 'snowy-castle') c.remove(); });
  for (let i = 0; i < 10; i++) {
    const div = document.createElement('div');
    div.className = 'tower-floor';
    div.id = 'tfloor-' + i;
    const win = document.createElement('div');
    win.className = 'floor-win';
    win.id = 'fwin-' + i;
    div.appendChild(win);
    tower.insertBefore(div, document.getElementById('snowy-castle'));
  }
  updateFrostyPosition(true);
}

function updateTower() {
  for (let i = 0; i < 10; i++) {
    const floor = document.getElementById('tfloor-' + i);
    const win   = document.getElementById('fwin-'   + i);
    if (!floor || !win) continue;
    floor.className = 'tower-floor' +
      (i < State.levelIdx ? ' f-cleared' : i === State.levelIdx ? ' f-current' : '');
    win.className = 'floor-win' +
      (i < State.levelIdx ? ' w-cleared' : i === State.levelIdx ? ' w-current' : '');
  }
  updateFrostyPosition(false);
}

function updateFrostyPosition(instant) {
  const el = document.getElementById('snowy-castle');
  if (!el) return;
  if (instant) { el.style.transition = 'none'; el.offsetHeight; }
  el.style.top = ((State.levelIdx + 0.3) / 10 * 100) + '%';
  if (instant) { el.offsetHeight; el.style.transition = ''; }
}

/* â”€â”€ 8. LEVEL STRIP (top progress bar) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function renderStrip() {
  const strip = document.getElementById('level-strip');
  strip.innerHTML = '';
  for (let i = 0; i < 10; i++) {
    const levelNum = 10 - i;   // i=0 â†’ Level 10, i=9 â†’ Level 1
    const div = document.createElement('div');
    div.className = 'level-block ';
    if (i < State.levelIdx)       div.className += 'cleared';
    else if (i === State.levelIdx) div.className += 'active';
    else                          div.className += 'upcoming';

    if (i < State.levelIdx)       div.textContent = 'â„ï¸';
    else if (i === State.levelIdx) div.innerHTML = '<img src="frosty.png" alt="Frosty" style="width:20px;height:auto;vertical-align:middle;">';
    else                          div.textContent = levelNum;
    strip.appendChild(div);
  }
}

/* â”€â”€ 8. GAME LOGIC â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function showRules() {
  Audio.init();
  showScreen('rules-screen');
}

/* Secret shortcut: Ctrl + Shift + W â†’ jump to win screen */
document.addEventListener('keydown', e => {
  if (e.ctrlKey && e.shiftKey && e.key === 'W') {
    Audio.init();
    showWin();
  }
});

function startGame() {
  Audio.init();
  Audio.startBg();
  State.levelIdx   = 0;
  State.questions  = pickQuestions();
  State.answering  = false;
  State.wrongCount = 0;
  updateMistakeCounter();
  loadLevel();
  initTower();
  showScene();   // scene first â€” question revealed when object is clicked
}

function restartGame() {
  Audio.stopBg();
  startGame();
}

function loadLevel() {
  const q        = State.questions[State.levelIdx];
  const levelNum = 10 - State.levelIdx;

  // HUD & labels
  document.getElementById('hud-level').textContent        = `ğŸ”ï¸ Level ${levelNum}`;
  document.getElementById('level-main-text').textContent  = `Level ${levelNum} of 10`;
  const left = 10 - State.levelIdx;
  document.getElementById('level-sub-text').textContent   =
    left === 1 ? 'ğŸšª Last level! Almost free!' :
                 `${left} levels left to escape!`;

  // Strip + castle tower
  renderStrip();
  updateTower();

  // Badge
  const badge = document.getElementById('q-badge');
  if (q.type === 'math') {
    badge.textContent = 'ğŸ”¢ Math'; badge.className = 'q-badge math';
  } else {
    badge.textContent = 'ğŸ“– English'; badge.className = 'q-badge english';
  }

  // Question
  document.getElementById('q-text').textContent = q.q;
  document.getElementById('feedback-msg').textContent = '';
  document.getElementById('feedback-msg').style.color = '';

  // Place correct answer at a guaranteed-random position (A/B/C/D equally likely)
  const correctText = q.opts[q.ans];
  const wrongOpts   = shuffle(q.opts.filter((_, i) => i !== q.ans));
  const shuffledAns = Math.floor(Math.random() * 4);
  wrongOpts.splice(shuffledAns, 0, correctText);
  const shuffledOpts = wrongOpts;

  const letters = ['A','B','C','D'];
  const grid = document.getElementById('options-grid');
  grid.innerHTML = '';
  shuffledOpts.forEach((opt, i) => {
    const btn = document.createElement('button');
    btn.className = 'option-btn';
    btn.innerHTML = `<span class="option-letter">${letters[i]}</span>${opt}`;
    btn.onclick   = () => checkAnswer(i, btn, shuffledAns, shuffledOpts);
    grid.appendChild(btn);
  });

  State.answering = false;
}

function updateMistakeCounter() {
  const count = State.wrongCount;
  const pipsEl = document.getElementById('mistake-pips');
  const countEl = document.getElementById('mistake-count');
  if (!pipsEl) return;

  // Rebuild pips
  pipsEl.innerHTML = '';
  for (let i = 0; i < 3; i++) {
    const pip = document.createElement('span');
    pip.className = 'mistake-pip' + (i < count ? ' filled' : '');
    if (i === count - 1) pip.classList.add('pop');  // animate the latest one
    pipsEl.appendChild(pip);
  }
  countEl.textContent = `${count} / 3`;
}

function checkAnswer(idx, btn, correctIdx, opts) {
  if (State.answering) return;
  State.answering = true;

  const btns = document.querySelectorAll('.option-btn');

  if (idx === correctIdx) {
    // â”€â”€ CORRECT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    btns.forEach(b => b.disabled = true);
    btn.classList.add('correct');
    Audio.correct();
    spawnParticles(btn, ['â„ï¸','â­','âœ¨','ğŸŒŸ','ğŸ’']);
    document.getElementById('feedback-msg').style.color = '#00e5a0';
    document.getElementById('feedback-msg').textContent = 'â„ï¸ Correct! Frosty slides down! â„ï¸';
    setTimeout(advance, 1200);

  } else {
    // â”€â”€ WRONG ANSWER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    State.wrongCount++;
    updateMistakeCounter();
    btns.forEach(b => b.disabled = true);
    btn.classList.add('wrong');
    btns[correctIdx].classList.add('correct');  // reveal the right answer
    Audio.wrong();
    document.getElementById('game-screen').classList.add('shake');
    setTimeout(() => document.getElementById('game-screen').classList.remove('shake'), 380);

    if (State.wrongCount >= 3) {
      // â”€â”€ THIRD MISTAKE â€” game over â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      document.getElementById('feedback-msg').style.color = '#ff6b6b';
      document.getElementById('feedback-msg').textContent = 'â„ï¸ No more chances â€” Frosty is stuck! ğŸ˜¢';
      setTimeout(showGameOver, 1800);
    } else {
      // â”€â”€ RESTART THIS LEVEL â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      const remaining = 3 - State.wrongCount;
      const msg = remaining === 1
        ? 'â„ï¸ Oops! Last chance â€” restarting level! ğŸ’ª'
        : `â„ï¸ Oops! ${remaining} chances left â€” try again! ğŸ’ª`;
      document.getElementById('feedback-msg').style.color = '#ff6b6b';
      document.getElementById('feedback-msg').textContent = msg;
      setTimeout(() => { loadLevel(); showScene(); }, 1800);
    }
  }
}

function advance() {
  State.levelIdx++;
  if (State.levelIdx >= 10) {
    showWin();
  } else {
    showLevelClear();
  }
}

function showLevelClear() {
  Audio.levelClear();
  const clearedNum = 10 - (State.levelIdx - 1);
  const nextNum    = clearedNum - 1;
  document.getElementById('lc-title').textContent = `Level ${clearedNum} Cleared! â­`;
  document.getElementById('lc-sub').textContent   =
    nextNum === 1
      ? 'Almost there â€” just one more level! ğŸšª'
      : `Frosty slides to Level ${nextNum}! â„ï¸`;

  // Retrigger the slope slide animation
  const snowy = document.getElementById('lc-snowy-char');
  snowy.classList.remove('sliding');
  snowy.offsetHeight;          // force reflow so animation restarts
  snowy.classList.add('sliding');

  showScreen('level-clear-screen');
  setTimeout(() => {
    loadLevel();
    showScene();   // scene before the next question
  }, 2400);
}

function showWin() {
  Audio.stopBg();
  Audio.startCheerfulBg();        // cheerful music plays during slide

  // Restart the CSS animation each time (so test mode works on repeat clicks)
  const slideImg = document.querySelector('.win-slide-img');
  slideImg.style.animation = 'none';
  slideImg.offsetHeight;          // force reflow
  slideImg.style.animation = '';

  showScreen('win-slide-screen'); // phase 1: just Frosty sliding across

  // Phase 2: after the 6s slide animation + small buffer, reveal win content
  setTimeout(() => {
    showScreen('win-screen');
    Audio.win();                  // fanfare on top of cheerful bg
    for (let i = 0; i < 20; i++) {
      setTimeout(() => {
        const fakeEl = { getBoundingClientRect: () => ({
          left: Math.random() * window.innerWidth,
          top:  Math.random() * window.innerHeight,
          width: 0, height: 0
        })};
        spawnParticles(fakeEl, ['â„ï¸','â­','ğŸ’','âœ¨','ğŸŒŸ','ğŸŒ¨ï¸']);
      }, i * 140);
    }
  }, 6400); // 400ms buffer after 6s animation
}

function showGameOver() {
  Audio.stopBg();
  showScreen('gameover-screen');
}

/* â”€â”€ Sparkle burst â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function spawnParticles(anchorEl, chars) {
  const rect = anchorEl.getBoundingClientRect();
  const cx = rect.left + rect.width  / 2;
  const cy = rect.top  + rect.height / 2;
  for (let i = 0; i < 8; i++) {
    const el = document.createElement('div');
    el.className = 'snow-particle';
    el.textContent = chars[Math.floor(Math.random() * chars.length)];
    el.style.left = cx + 'px';
    el.style.top  = cy + 'px';
    el.style.setProperty('--dx', (Math.random() * 120 - 60) + 'px');
    el.style.setProperty('--dy', (Math.random() * -100 - 20) + 'px');
    el.style.fontSize = (15 + Math.random() * 13) + 'px';
    document.body.appendChild(el);
    setTimeout(() => el.remove(), 1400);
  }
}

/* â”€â”€ Mute â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function toggleMute() {
  Audio.init();
  const muted = Audio.toggleMute();
  document.getElementById('mute-btn').textContent = muted ? 'ğŸ”‡' : 'ğŸ”Š';
}
</script>
</body>
</html>
